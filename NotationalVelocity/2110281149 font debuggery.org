#+TITLE: font debuggery
# Tags #emacs #unicode
# Backlink: ¬ß2109110841 unicode characters

** To see what a particular block contains:
*** In emacs

    #+begin_src emacs-lisp
      (unicode-fonts-debug-insert-block)
    #+end_src
    It will ask for a block name if it's not given as a parameter.

*** online

    https://babelstone.co.uk/Unicode/babelmap.html

** edit the fonts set for a block with:

    #+begin_src emacs-lisp
      (customize-variable 'unicode-fonts-block-font-mapping)
    #+end_src

** get a list of installed fonts

    #+begin_src bash
    convert -list font
    #+end_src

** get a list of fonts containing a given character
*** shell command from https://unix.stackexchange.com/a/393740/238480
    This will give a list of installed fonts that can display the 2 specified characters. 
    The character specification comes from *code point in charset:* as seen in *describe-char*
    The second variation will just give the *family* that is needed by *set-fontset-font*
    #+begin_src bash
      # fc-list ':charset=<hex_code1> <hex_code2>'
      fc-list ':charset=2713 2717'
      fc-list ':charset=2713' : family
    #+end_src
    
    #+RESULTS:

*** python script from https://superuser.com/a/1452828/169596

    Doesn't give me anything useful, but shouldn't be too hard to fix if necessary.
    #+begin_src python
      import unicodedata
      import os
    
      fonts = []
    
      for root,dirs,files in os.walk("/System/Library/Fonts/"):
          for file in files:
             if file.endswith(".ttf"): fonts.append(os.path.join(root,file))
    
    
      from fontTools.ttLib import TTFont
    
      def char_in_font(unicode_char, font):
          for cmap in font['cmap'].tables:
              if cmap.isUnicode():
                  if ord(unicode_char) in cmap.cmap:
                      return True
          return False
    
      def test(char):
          for fontpath in fonts:
              font = TTFont(fontpath)   # specify the path to the font in question
              if char_in_font(char, font):
                  print(char + " "+ unicodedata.name(char) + " in " + fontpath)
    
      test(u"üò∫")
      test(u"üêà")
    #+end_src
    
    #+RESULTS:
    : None

