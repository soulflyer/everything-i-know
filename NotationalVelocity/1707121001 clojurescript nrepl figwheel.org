#+TITLE: clojurescript nrepl figwheel
# TAGS #clojurescript

Added dependancy for piggieback to project.clj

                 [com.cemerick/piggieback "0.2.2"]
                 
Added :nrepl-port to :figwheel section of project.clj

:figwheel {:http-server-root "public"
             :ring-handler figwheel-middleware/app
             :server-port 3449
             :repl false
             :nrepl-port 7002
             
             
run lein figwheel as normal, but then connect to the nrepl port using cider-connect. Open the web page or start the electron app and In the repl run:

(use 'figwheel-sidecar.repl-api)
(cljs-repl)

test connection with:

(js/alert "hello")

Note: added this to ~/.lein/profile.clj

{:dev {:dependencies [[com.cemerick/piggieback "0.2.2"]
                      [org.clojure/tools.nrepl "0.2.12"]]
       :repl-options {:nrepl-middleware [cemerick.piggieback/wrap-cljs-repl]}
       
This didn't help for installing the dependancies, but the middleware may be in use. Don't know.

Also needed to add these plugins:
            [cider/cider-nrepl "0.14.0"]
            [refactor-nrepl "2.3.1"]
            
and middleware to the :figwheel section of project.clj to get rid of the out of sync warnings 

  :figwheel {:http-server-root "public"
             :ring-handler figwheel-middleware/app
             :server-port 3449
             :nrepl-middleware ["cider.nrepl/cider-middleware"
                                "refactor-nrepl.middleware/wrap-refactor"
                                "cemerick.piggieback/wrap-cljs-repl"]
             :repl false
             :nrepl-port 7002}

*******************************************************************************************************
This may be a better method:
https://github.com/bhauman/lein-figwheel/wiki/Using-the-Figwheel-REPL-within-NRepl
*******************************************************************************************************
Add this to profile.clj (or possibly ~/.lein/profiles.clj)

:profiles {:dev {:dependencies [[figwheel-sidecar "0.5.11"]]}}

Jack-in to a clojure repl then run:

(use 'figwheel-sidecar.repl-api)
(start-figwheel!)
(cljs-repl)

and start or refresh the browser
